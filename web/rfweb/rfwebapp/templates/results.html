{% extends "base.html" %}

{% block content %}
<script language="JavaScript" type="text/javascript">
    function get_checked(name) {
        var checked_array = new Array();
        var check_obj = document.getElementsByName(name);
        var i;
        var count = 0;
        for (i=0; i < check_obj.length; i++)
            if (check_obj[i].checked) {
                checked_array[count] = check_obj[i].id;
                count++;
            }
        return checked_array;
    }
function toggle_visibility(id) {
    var e = document.getElementById(id);
    if(e.style.display == 'block')
        e.style.display = 'none';
    else
        e.style.display = 'block';
    return;
}
function toggle_check_all(name, state) {
    var check_obj = document.getElementsByName(name);
    for (var i=0; i < check_obj.length; i++) {
        check_obj[i].checked = state;
    }
    return;
}
</script>

<h2>Results</h2>

{% if results and results.object_list %}
<table class="tasks" id="tasks" valign=top>
    <th><input type="checkbox" name="select_all" id="select_all" onclick="toggle_check_all('select', this.checked)" />All</th>
    {% for field in results.object_list.0.get_fields_names %}
    <th>{{ field }}</th>
    {% endfor %}
    <th>View result</th>
    <th>Download result</th>
    {% for result in results.object_list %}
    <tr>
        {% if result.ip and result.hwaddr %}
        <td><input type="checkbox" name="select" id="ololo" /></td>
        {% for field, value in result.get_fields %}
        {% if field == "viewed" %}
        {% if value == "True" %}
        <td class="checked">Checked</td>
        {% else %}
        <td class="new">New!</td>
        {% endif %}
        {% else %}
        {% if field == "status" %}
        {% if not result.finish %}
        <td class="unknown">unknown</td>
        {% else %}
        {% if value == "True" %}
        <td class="pass">PASS</td>
        {% else %}
        <td class="fail">FAIL</td>
        {% endif %}
        {% endif %}
        {% else %}
        {% if field == "finish" and not value %}
        <td class="progress">still running</td>
        {% else %}
        <td>{{ value }}</td>
        {% endif %}
        {% endif %}
        {% endif %}
    </td>
    {% endfor %}
    <td>
    {% if result.finish %}
    <a href="{{ result.url_to_results }}/report.html">{{ result.url_to_results }}</a>
    {% endif %}
    </td>
    <td>
    {% if result.finish %}
    <a href="/download/{{ result.results_name }}.zip">{{ result.results_name }}.zip</a>
    {% endif %}
    </td>
    {% endif %}
</tr>
{% endfor %}
</table>
<div class="pagination">
    <span class="step-links">
        {% if results.has_previous %}
        <a href="?page={{ results.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ results.number }} of {{ results.paginator.num_pages }}.
        </span>

        {% if results.has_next %}
        <a href="?page={{ results.next_page_number }}">next</a>
        {% endif %}
    </span>
</div>
{% else %}
No results
{% endif %}
{% endblock content %}

