{% extends "base.html" %}

{% block content %}
<script language="JavaScript" type="text/javascript">
    function getChecked(name) {
        var checked_array = new Array();
        var check_obj = document.getElementsByName(name);
        var i;
        var count = 0;
        for (i=0; i < check_obj.length; i++) {
            if (check_obj[i].checked) {
                checked_array[count] = check_obj[i].id;
                count++;
            }
        }
        return checked_array;
    }
<!--
    function toggle_visibility(id) {
       var e = document.getElementById(id);
       if(e.style.display == 'block')
          e.style.display = 'none';
       else
          e.style.display = 'block';
    }
//-->
</script>

<h2>Tasks</h2>

<table class="tasks" id="tasks" valign=top>
    <th><input type="checkbox" name="select_all" id="select_all" />Select all</th>
    {% for field in tasks.0.fields %}
    <th>{{ field }}</th> 
    {% endfor %}
    {% for task in tasks %}
    <tr>
        <td>
            <input type="checkbox" name="select" id="{{ task.pk }}" />
        </td>
        {% for field, value in task.fields.items %}
        <td>
            {% if field == 'tests' %}
            <a href="#tests" onclick="toggle_visibility('tests_{{ task.pk }}');Dajaxice.rfweb.rfwebapp.show_task_tests(Dajax.process, {'task_id': {{ task.pk }}, 'test_ids': '{{ value }}'})"><h3>Show tests</h3></a>
            <div id='tests_{{ task.pk }}' style="display: none">
            </div>
            {% else %}
            {{ value }}
            {% endif %}
        </td>
        {% endfor %}
    </tr>
    {% endfor %}
</table>
<input type="button" value="Start selected" id="start" onclick="Dajaxice.rfweb.rfwebapp.start_tasks(Dajax.process, {'selected': getChecked('select')})" />   
<input type="button" value="Stop selected" id="stop" onclick="Dajaxice.rfweb.rfwebapp.stop_tasks(Dajax.process, {'selected': getChecked('select')})" /><br>
<a href="#logs" onclick="toggle_visibility('show_logs');"><h2>Logs</h2></a>
<textarea id="show_logs" name="show_logs" style="display:none">recent logs should be here</textarea>
{% endblock content %}

